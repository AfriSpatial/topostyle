Dropping columns not needed from postgis database.

ALTER TABLE airtransportarea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;


ALTER TABLE artificialsurfacearea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;


ALTER TABLE artificialsurfaceline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;


ALTER TABLE artificialsurfacepoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;


ALTER TABLE barrierline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE boundaryareaarea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;


ALTER TABLE boundarylineline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE buildingarea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE buildingpoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE coastalarea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE coastalline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE controlpointpoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE drainagelineline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE inlandwaterarea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE islandarea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE landusearea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE landuseline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE magneticline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE magneticpoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE navigationalaidpoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE railwayarea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE railwayline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE railwaypoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE reliefline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE reliefpoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE riverarea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE riverline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE roadline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE structurearea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE structureline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;


ALTER TABLE structurepoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;


ALTER TABLE topoareaarea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE topolineline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE topopointpoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE vegetationarea DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE vegetationline DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE vegetationpoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE watersourcepoint DROP COLUMN row_status,drop column lock_date,drop column selection_,drop column version_nu,drop column version_da,drop column modified_b,drop column retired_da,drop column original_g,drop column data_sourc,drop column est_revisi,drop column source_pro,drop column source_con,drop column capture_in,drop column descriptio;

ALTER TABLE hypselevationpointsm DROP COLUMN job_nr, drop column cuid,drop column feature_re,drop column attr_relia,drop column capture_so,
drop column capture_me,drop column entity_nam,drop column geometry_t,drop column old_gdo_gi,drop column locked_fla,drop column sdo_gtype,
drop column reference_;

ALTER TABLE hypselevationlinesm  DROP COLUMN job_nr, drop column cuid,drop column feature_re,drop column attr_relia,drop column capture_so,
drop column capture_me,drop column entity_nam,drop column geometry_t,drop column old_gdo_gi,drop column locked_fla,drop column sdo_gtype,
drop column reference_;

--Merging some layers in postgis.

insert into airtransportarea(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from airtransport

insert into boundarylineline(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from boundaryline

insert into boundaryareaarea(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from boundaryarea

insert into controlpointpoint(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from controlpoint

insert into drainagelineline(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from drainageline

insert into roadline(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from road

insert into topolineline(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from topoline

insert into topopointpoint(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from topopoint

insert into topoareaarea(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from topoarea

insert into topoline(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from topoarealine

insert into inlandwaterarea(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from inlandwater

insert into boundarylineline(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from boundaryline

insert into boundaryareaarea(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from boundaryarea

insert into reliefpoint(feat_type,height,geom) select feat_type_,height,geom from hypselevationpointsm

insert into reliefline(feat_type,height,geom) select feat_type_,height,geom from hypselevationlinesm

insert into inlandwaterarea(tag,feat_type,geom_type,create_dat,geom) select tag,feat_type,geom_type,create_dat,geom from flightplanarea


--Deleting data from tables with mixed geometries



delete from structurearea where geom is null

delete from artificialsurfaceline where geom is null

delete from barrierline where geom is null

delete from boundarylineline where geom is null

delete from buildingarea where geom is null

delete from buildingpoint where geom is null

delete from drainagelineline where geom is null

delete from inlandwaterarea where geom is null

delete from landusearea where geom is null

delete from landuseline where geom is null

delete from railwayarea where geom is null

delete from railwaypoint where geom is null

delete from reliefpoint where geom is null

delete from riverarea where geom is null

delete from riverline where geom is null

delete from riverline where geom is null

delete from roadline where geom is null

delete from structureline where geom is null

delete from structurepoint where geom is null

delete from topoareaarea where geom is null

delete from topolineline where geom is null

delete from topopointpoint where geom is null

delete from vegetationarea where geom is null

delete from vegetationline where geom is null

delete from vegetationpoint where geom is null

delete from watersourcepoint where geom is null


--checking to see how many points exist in a geometry(multipoint)

SELECT COUNT(CASE WHEN ST_NumGeometries(geom) > 1 THEN 1 END) AS multi_geom,
       COUNT(geom) AS total_geom
FROM hypselevationpointsm;


--to convert the multi geometry to single geometry use the following:

ALTER TABLE hypselevationpointsm
    ALTER COLUMN geom TYPE geometry(Point,4326) USING ST_GeometryN(geom, 1);

--dropping tables not needed since the merger of data:

drop table hypselevationlinesm,hypselevationpointsm;

drop table airtransport,boundaryline,boundaryarea,controlpoint,drainageline,road,topoline,topopoint,topoarea,topoarealine,inlandwater
,boundaryline,boundaryarea,hypselevationpointsm,hypselevationlinesm,flightplanarea




































